(self["webpackChunktypesense_dashboard"]=self["webpackChunktypesense_dashboard"]||[]).push([[292],{25816:(e,t,i)=>{"use strict";i.d(t,{Z:()=>v});var l=i(83673);const o=(0,l.HX)("data-v-46f34a38");(0,l.dD)("data-v-46f34a38");const d={ref:"editorWrapper",class:"col relative-position overflow-hidden editorWrapper"},r={ref:"editorElement",class:"absolute-top-left"};(0,l.Cn)();const n=o(((e,t,i,o,n,a)=>{const s=(0,l.up)("q-resize-observer");return(0,l.wg)(),(0,l.j4)("div",d,[(0,l.Wm)(s,{onResize:e.onResize},null,8,["onResize"]),(0,l.Wm)("div",r,null,512)],512)}));var a=i(55725),s=i(61959);const u=(0,l.aZ)({name:"MonacoEditor",props:{modelValue:{type:String,default:""},options:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:t}){const i=(0,s.iH)(null),o=(0,s.iH)(null);let d;return(0,l.bv)((()=>{d=a.editor.create(i.value,Object.assign({value:e.modelValue,language:"json",theme:"vs-dark",minimap:{enabled:!1}},e.options)),d.onDidChangeModelContent((()=>{t("update:modelValue",null===d||void 0===d?void 0:d.getValue())}))})),(0,l.Ah)((()=>{null===d||void 0===d||d.dispose()})),(0,l.YP)((()=>e.modelValue),(()=>{var t;e.modelValue!==(null===d||void 0===d?void 0:d.getValue())&&(null===(t=null===d||void 0===d?void 0:d.getModel())||void 0===t||t.setValue(e.modelValue),null===d||void 0===d||d.setScrollPosition({scrollTop:0}))})),{editorElement:i,editorWrapper:o,onResize(){null===d||void 0===d||d.layout({height:0,width:0}),window.setTimeout((()=>{null===d||void 0===d||d.layout({height:o.value.offsetHeight,width:o.value.offsetWidth})}))}}}});var c=i(15151),p=i(7518),m=i.n(p);u.render=n,u.__scopeId="data-v-46f34a38";const v=u;m()(u,"components",{QResizeObserver:c.Z})},65292:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>O});var l=i(83673),o=i(62323);function d(e,t,i,d,r,n){const a=(0,l.up)("q-input"),s=(0,l.up)("q-card-section"),u=(0,l.up)("monaco-editor"),c=(0,l.up)("q-banner"),p=(0,l.up)("q-btn"),m=(0,l.up)("q-card-actions"),v=(0,l.up)("q-card"),h=(0,l.up)("q-expansion-item"),f=(0,l.up)("q-icon"),g=(0,l.up)("q-td"),b=(0,l.up)("q-table"),w=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(w,{padding:""},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{"expand-separator":"",icon:"low_priority",label:(e.isUpdate?"Update":"Add")+" Curration","header-class":"bg-primary text-white",modelValue:e.expanded,"onUpdate:modelValue":t[4]||(t[4]=t=>e.expanded=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{style:{height:"60vh"},class:"bg-grey-3 column"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,null,{default:(0,l.w5)((()=>[(0,l.Wm)(a,{dense:"",filled:"","bg-color":"white",label:"ID",modelValue:e.id,"onUpdate:modelValue":t[1]||(t[1]=t=>e.id=t)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(u,{modelValue:e.overrideJson,"onUpdate:modelValue":t[2]||(t[2]=t=>e.overrideJson=t)},null,8,["modelValue"]),e.jsonError?((0,l.wg)(),(0,l.j4)(c,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Invalid Format: "+(0,o.zw)(e.jsonError),1)])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(m,{align:"right",class:"bg-primary"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{size:"md",padding:"sm lg",unelevated:"",color:"primary",disable:!e.isValid,onClick:t[3]||(t[3]=t=>e.createOverride())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.isUpdate?"Update":"Add")+" Curation",1)])),_:1},8,["disable"])])),_:1})])),_:1})])),_:1},8,["label","modelValue"]),(0,l.Wm)(b,{class:"q-mt-md",title:"Curations",flat:"",bordered:"",filter:e.filter,rows:e.$store.state.node.data.overrides,columns:e.columns,"row-key":"id","visible-columns":["query","match","includes","excludes","actions"]},{"top-right":(0,l.w5)((()=>[(0,l.Wm)(a,{borderless:"",dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":t[5]||(t[5]=t=>e.filter=t),placeholder:"Search"},{append:(0,l.w5)((()=>[(0,l.Wm)(f,{name:"search"})])),_:1},8,["modelValue"])])),"body-cell-actions":(0,l.w5)((t=>[(0,l.Wm)(g,{class:"text-right"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{flat:"",color:"primary",onClick:i=>e.editOverride(t.row),icon:"edit",title:"Edit"},null,8,["onClick"]),(0,l.Wm)(p,{flat:"",color:"negative",onClick:i=>e.deleteOverride(t.row.id),icon:"delete_forever",title:"Delete"},null,8,["onClick"])])),_:2},1024)])),_:1},8,["filter","rows","columns"])])),_:1})}var r=i(73414),n=i(25816),a=function(e,t,i,l){function o(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,d){function r(e){try{a(l.next(e))}catch(t){d(t)}}function n(e){try{a(l["throw"](e))}catch(t){d(t)}}function a(e){e.done?i(e.value):o(e.value).then(r,n)}a((l=l.apply(e,t||[])).next())}))};const s={rule:{query:"apple",match:"exact"},includes:[{id:"422",position:1},{id:"54",position:2}],excludes:[{id:"287"}]},u=(0,l.aZ)({components:{MonacoEditor:n.Z},name:"Overrides",data(){return{id:(0,r.x0)(),override:s,jsonError:null,expanded:0===this.$store.state.node.data.overrides.length,filter:"",columns:[{label:"ID",name:"id",field:"id"},{label:"Query",name:"query",field:e=>e.rule.query,sortable:!0,align:"left"},{label:"Match",name:"match",field:e=>e.rule.match,sortable:!0,align:"left"},{label:"Includes",name:"includes",field:e=>{var t;return null===(t=e.includes)||void 0===t?void 0:t.length}},{label:"Excludes",name:"excludes",field:e=>{var t;return null===(t=e.excludes)||void 0===t?void 0:t.length}},{label:"Actions",name:"actions",align:"right"}]}},computed:{isValid(){return this.id.length>0&&!this.jsonError},isUpdate(){return this.$store.state.node.data.overrides.map((e=>e.id)).includes(this.id)},overrideJson:{get(){return JSON.stringify(this.override,null,2)},set(e){try{this.override=JSON.parse(e),this.jsonError=null}catch(t){this.jsonError=t.message}}}},methods:{createOverride(){return a(this,void 0,void 0,(function*(){yield this.$store.dispatch("node/createOverride",{id:this.id,override:JSON.parse(JSON.stringify(this.override))}),this.id=(0,r.x0)(),this.override=s,this.expanded=!1}))},editOverride(e){this.override=JSON.parse(JSON.stringify(e)),this.id=e.id||(0,r.x0)(),this.expanded=!0},deleteOverride(e){this.$q.dialog({title:"Confirm",message:`Delete curation with id: ${e}?`,cancel:!0,persistent:!0}).onOk((()=>{this.$store.dispatch("node/deleteOverride",e)}))}}});var c=i(24379),p=i(64615),m=i(10151),v=i(25589),h=i(34842),f=i(15607),g=i(99367),b=i(48240),w=i(83243),y=i(24554),V=i(83884),x=i(7518),q=i.n(x);u.render=d;const O=u;q()(u,"components",{QPage:c.Z,QExpansionItem:p.Z,QCard:m.Z,QCardSection:v.Z,QInput:h.Z,QBanner:f.Z,QCardActions:g.Z,QBtn:b.Z,QTable:w.Z,QIcon:y.Z,QTd:V.Z})}}]);